



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-4.6.3">
    
    
      
        <title>Terraform - Kapitan documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.adb8469c.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.86422ebf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#terraform-example" tabindex="0" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="Kapitan documentation" aria-label="Kapitan documentation" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Kapitan documentation
            </span>
            <span class="md-header-nav__topic">
              
                Terraform
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" aria-label="search" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/deepmind/kapitan/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    deepmind/kapitan
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="Kapitan documentation" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Kapitan documentation
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/deepmind/kapitan/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    deepmind/kapitan
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../contributing/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Getting started
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Getting started
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../kapitan_overview/" title="Kapitan Overview" class="md-nav__link">
      Kapitan Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../inventory/" title="Inventory" class="md-nav__link">
      Inventory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../compile/" title="Compiling components/templates" class="md-nav__link">
      Compiling components/templates
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Kapitan features
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Kapitan features
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../secrets/" title="Secret management" class="md-nav__link">
      Secret management
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../validate/" title="Manifest validation" class="md-nav__link">
      Manifest validation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../external_dependencies/" title="External dependency management" class="md-nav__link">
      External dependency management
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Miscellaneous
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Miscellaneous
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../CI/" title="Continuous Integration" class="md-nav__link">
      Continuous Integration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../pyenv-scl/" title="Set up kapitan on older Python systems" class="md-nav__link">
      Set up kapitan on older Python systems
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../usage/" title="Usage" class="md-nav__link">
      Usage
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../proposals/" title="Proposals" class="md-nav__link">
      Proposals
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" checked>
    
    <label class="md-nav__link" for="nav-6">
      Examples
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Examples
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../example-kubernetes/" title="Kubernetes" class="md-nav__link">
      Kubernetes
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Terraform
      </label>
    
    <a href="./" title="Terraform" class="md-nav__link md-nav__link--active">
      Terraform
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#directory-structure" class="md-nav__link">
    Directory structure
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inventory" class="md-nav__link">
    inventory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#components" class="md-nav__link">
    components
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#templates-docs-scripts" class="md-nav__link">
    templates, docs, scripts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#secrets" class="md-nav__link">
    secrets
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#collaboration" class="md-nav__link">
    Collaboration
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#directory-structure" class="md-nav__link">
    Directory structure
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inventory" class="md-nav__link">
    inventory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#components" class="md-nav__link">
    components
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#templates-docs-scripts" class="md-nav__link">
    templates, docs, scripts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#secrets" class="md-nav__link">
    secrets
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#collaboration" class="md-nav__link">
    Collaboration
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/deepmind/kapitan/edit/master/docs/example-terraform.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="terraform-example">Terraform example</h1>
<p>We will be looking at how to use Kapitan to compile terraform files with Jsonnet as the input type. It's possible to use other input types, however, Jsonnet is recommended. 
For example, we could use the Kadet input to generate terraform files but this would require templates to be written in YAML then rendered into JSON.
It is possible to allow Kadet to consume JSON as an input. This enables you to integrate your organizations pre-existing terraform JSON file's as templates.
Jsonnet is the most straightforward input type as you will see due to its functional nature. The only appropriate output type is JSON since this is the format that Terraform consumes.</p>
<h2 id="directory-structure">Directory structure</h2>
<p>There are several examples available in <code>examples/terraform</code>. This will be our working directory for this documentation. The directory structure is as follows:
<div class="highlight"><pre><span></span><code>├── inventory
└── templates
</code></pre></div></p>
<p>It is possible to further extend this locally to include a <code>lib</code> directory where a <code>terraform.libjsonnet</code> file can be stored for use. This is generally dependent on the project scope and organizational patterns. 
We will describe in more detail the role of each of these folders in the following sections.</p>
<h3 id="inventory">inventory</h3>
<p>This folder contains the inventory files used to render the templates for each target. The structure of this folder is as follows:</p>
<div class="highlight"><pre><span></span><code>.
├── classes
│   ├── env
│   │   ├── develop.yml
│   │   ├── prod.yml
│   │   └── sandbox.yml
│   ├── provider
│   │   └── gcp.yml
│   └── type
│       └── terraform.yml
├── reclass-config.yml
└── targets
    ├── develop
    │   └── project1.yml
    ├── prod
    │   └── project2.yml
    └── sandbox
        └── project3.yml
</code></pre></div>

<p>The <code>targets</code> directory enables us to define various projects. We can specify each project as an environment such as <code>dev</code>, <code>staging</code> and <code>production</code> with each having unique parameters.</p>
<p>The following is an example targets file. <code>type.terraform</code> is what defines the entry point into the main Jsonnet template file. The parameters in the file <code>inventory/targets/develop/project1.yml</code> will then be utilized to set the environmental specific provider/resource configuration.
We define the default region and zone for terraform's provider configuration. The default DNS TTL for the DNS resource is also configured for the development environment.</p>
<div class="highlight"><pre><span></span><code><span class="nt">classes</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type.terraform</span>

<span class="nt">parameters</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">project1</span>
  <span class="nt">region</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">europe-west2</span>
  <span class="nt">zone</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">europe-west2-a</span>

  <span class="nt">dns_default_ttl</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">300</span>
</code></pre></div>

<p>In the following example, we use a reclass configuration file to specify further parameters that we would like to merge into our project files. Thus we define nodes, which are stored in targets and environmental mandatory parameters stored in <code>classes/env/</code>.  The reclass config is shown below:</p>
<div class="highlight"><pre><span></span><code><span class="nt">storage_type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">yaml_fs</span>
<span class="nt">pretty_print</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">output</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">yaml</span>
<span class="nt">inventory_base_uri</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">.</span>
<span class="nt">nodes_uri</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">targets</span>
<span class="nt">classes_uri</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">classes</span>
<span class="nt">compose_node_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">class_mappings</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">develop/*                          env.develop</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">prod/*                             env.prod</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">sandbox/*                          env.sandbox</span>
</code></pre></div>

<p>The following class <code>provider.gcp</code> will be found in all files in this path since it is a common configuration for the cloud authentication module.</p>
<div class="highlight"><pre><span></span><code><span class="nt">classes</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">provider.gcp</span>
</code></pre></div>

<p>Further classes that group parameters together can be included. To assist in further refining the configuration. </p>
<h3 id="components">components</h3>
<p>We tend to use components as a method to organize Jsonnet files. This is not mandatory since it is possible to configure Kapitan to look for input files wherever you would like.
You can have these in any path just ensure you define that path in <code>inventory/classes/type/terraform.yml</code>.</p>
<p>The templates folder is where the Jsonnet is located in this instance as shown below:</p>
<div class="highlight"><pre><span></span><code>.
├── cloudbuild.jsonnet
├── dns.jsonnet
├── iam.jsonnet
├── iam_service_account.jsonnet
├── kms.jsonnet
├── kubernetes.jsonnet
├── logging.jsonnet
├── main.jsonnet
├── monitoring.jsonnet
├── org_iam.jsonnet
├── output.jsonnet
├── provider.jsonnet
├── pubsub.jsonnet
├── README.md.j2
└── storage.jsonnet
</code></pre></div>

<p>The main thing to understand about terraform components is that they are strictly handled by Jsonnet for simplicity. The rendering logic is as follows:</p>
<div class="highlight"><pre><span></span><code>{
  &quot;output.tf&quot;: output,
  &quot;provider.tf&quot;: provider,
  [if name_in_resoures(&quot;cloudbuild&quot;) then &quot;cloudbuild.tf&quot;]: cloudbuild,
  [if name_in_resoures(&quot;container&quot;) then &quot;kubernetes.tf&quot;]: kubernetes,
  [if name_in_resoures(&quot;dns&quot;) then &quot;dns.tf&quot;]: dns,
  [if name_in_resoures(&quot;iam&quot;) &amp;&amp; &quot;serviceaccounts&quot; in p.resources.iam then &quot;iam_service_account.tf&quot;]: iam_service_account,
...
  [if name_in_resoures(&quot;pubsub&quot;) then &quot;pubsub.tf&quot;]: pubsub,
  [if name_in_resoures(&quot;storage&quot;) then &quot;storage.tf&quot;]: storage,
}
</code></pre></div>

<p>Each Jsonnet file defines a resource and then it is imported. Jsonnet then filters through all the inventory parameters to find specific keys that have been defined. Let's take for example the cloud build resource: </p>
<div class="highlight"><pre><span></span><code>local cloudbuild = import &quot;cloudbuild.jsonnet&quot;;
...
{
  &quot;output.tf&quot;: output,
  &quot;provider.tf&quot;: provider,
  [if name_in_resoures(&quot;cloudbuild&quot;) then &quot;cloudbuild.tf&quot;]: cloudbuild,
...
}
</code></pre></div>

<p>Assuming that one of the configuration files for a specific environment has the parameter key <code>cloudbuild</code> set. 
These parameters will then be interpreted by the <code>cloudbuild.jsonnet</code> template. 
A file named <code>cloudbuild.tf.json</code> will then be compiled using the parameters associated with the <code>cloudbuild</code> parameter key. </p>
<p>It is important to understand that once you have a deeper understanding of Kapitan's capabilities, you can organize these files to a style and logic suitable for your organization.</p>
<h3 id="templates-docs-scripts">templates, docs, scripts</h3>
<p>Jinja2 is used to generate documentation that sources information from kapitan's inventory. This enables the ability to have dynamic documentation based on your infrastructure configuration changes.
In <code>templates/terraform</code> you will find <code>README.md.j2</code>. This is used to generate a <code>README.md</code> template to be utilized by terraform's output module.</p>
<p>The following is what generates the documentation:</p>
<div class="highlight"><pre><span></span><code>  data: {
    template_file: {
      readme: {
        template: kap.jinja2_template(&quot;templates/terraform/README.md.j2&quot;, inv),
      },
    },
  },

  output: {
    &quot;README.md&quot;: {
      value: &quot;${data.template_file.readme.rendered}&quot;,
      sensitive: true,
    },
  },
</code></pre></div>

<p>The function <code>kap.jinja2_template()</code> (imported from <code>kapitan.libjsonnet</code>) is used to convert and interpreter the <code>README.md.j2</code> file into a raw string using the inventory for evaluation logic.</p>
<p>Based on the various parameters jinja2 decides which sections of the readme should be included. 
When terraform runs it will use the output module to generate your desired <code>README.md</code> using information from terraform's state.</p>
<p>Scripts are located in the <code>scripts</code> directory. They are compiled using jinja2 as the templating language. An example is as follows:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span> <span class="nv">TF_DATA_DIR</span><span class="o">=</span><span class="k">$(</span>realpath -m <span class="si">${</span><span class="nv">DIR</span><span class="si">}</span>/../../../.TF_DATA_DIR/<span class="o">{{</span>inventory.parameters.name<span class="o">}}</span><span class="k">)</span> <span class="c1"># Folder for TF initialization (preferable outside of compiled)</span>
<span class="nb">export</span> <span class="nv">OUTPUT_DIR</span><span class="o">=</span><span class="k">$(</span>realpath -m <span class="si">${</span><span class="nv">DIR</span><span class="si">}</span>/../../../output/<span class="o">{{</span>inventory.parameters.name<span class="o">}}</span><span class="k">)</span> <span class="c1"># Folder for storing output files (preferable outside of compiled)</span>
</code></pre></div>

<p>It is good practice to utilize this method to improve integration with various CLI based tools. Scripts help to ensure terraform and
kapitan can function with your CI/CD systems. It generally depends on your organizational workflows. </p>
<h3 id="secrets">secrets</h3>
<p>Although there are no particular secrets in this instance. It is possible to utilize Kapitan secrets as defined in <a href="../secrets/">secrets management</a>.</p>
<h3 id="collaboration">Collaboration</h3>
<p>In some situations you may find teams that are used to writing terraform in HCL. In such situations it may be difficult to adopt Kapitan into the companies workflows.
We can however use terraform modules to simplify the integration process. This means teams which are used to writing in HCL will not need to completely adopt Jsonnet. </p>
<p>Modules can be imported into projects by defining them under the <code>modules</code> parameter key as shown in <code>inventory/targets/sandbox</code>. This means teams will only have to worry about coordinating parameter inputs for different projects.
Jsonnet provides the ability to specify conventions and validation of input parameters. This provides peace of mind to infrastructure administrators around the tools usage.</p>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../example-kubernetes/" title="Kubernetes" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Kubernetes
              </span>
            </div>
          </a>
        
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org" target="_blank" rel="noopener">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.c33a9706.js"></script>
      
      <script>app.initialize({version:"1.1",url:{base:".."}})</script>
      
    
  </body>
</html>