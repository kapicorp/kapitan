classes:
  - tools.nginx._helm

# -------------------------------------------------
# Nginx configuration
# -------------------------------------------------
parameters:
  # -----------------------------------------------
  # Nginx
  # -----------------------------------------------
  nginx-infra-aaa: ${merge:${nginx}, ${nginx-infra-common-aaa}}
  nginx-infra-bbb: ${merge:${nginx}, ${nginx-infra-common-bbb}}

  nginx-infra-common-aaa:
    group: aaa
    tolerations:
      - key: "my.topology.io/zone"
        operator: "Equal"
        value: backend
        effect: "NoSchedule"

  nginx-infra-common-bbb:
    group: bbb
    tolerations:
      - key: "my.topology.io/zone"
        operator: "Equal"
        value: backend
        effect: "NoSchedule"

  # -----------------------------------------------
  # KAPITAN COMPILE
  # -----------------------------------------------
  kapitan:
    compile:
      - ${helm_input:nginx-infra-aaa}
      - ${helm_input:nginx-infra-bbb}
    dependencies:
      - ${helm_dep:nginx-infra-aaa, ${nginx.chart_url}}
      - ${helm_dep:nginx-infra-bbb, ${nginx.chart_url}}
